!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.metrixjs=t():e.metrixjs=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetrixNoop=t.Metrix=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1)),i=a(n(2)),u=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var u=t[o](i),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c="undefined"!=typeof document,_="/metrix",f="_pmx",l=524160,d="_pmxb",h=15,I="_pmxz",p=h,T="_pmxr",S=100,v=6e4,O=t.Metrix=function(){function e(t,n,r,a){var O=this;if(E(this,e),this.cleanUp=function(){O.intervalHandler&&clearInterval(O.intervalHandler),O.intervalHandler=null},this.identify=s(regeneratorRuntime.mark(function e(){var t,n,r,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.storage.getCookies([f,d,I,T]);case 2:return t=e.sent,(n=t[f])||(n=o.generateUID()),e.next=7,O.storage.setCookie(f,n,l);case 7:return(r=t[d])||(r=o.generateUID()),e.next=11,O.storage.setCookie(d,r,h);case 11:return(i=t[I])||(i=window.location.search.substr(1)),e.next=15,O.storage.setCookie(I,i,p);case 15:return(u=t[T])||(u=c?document.referrer:""),e.next=19,O.storage.setCookie(T,u,p);case 19:o.log("clientID:",n),O.clientID=n,O.sessionID=r,O.sessionQS=i,O.referrer=u;case 24:case"end":return e.stop()}},e,O)})),this.enqueue=function(e){o.log("tracking",e),O.queue.push(e),O.sync()},this.dispatch=function(){if(0!=O.queue.length){for(var e={v:O.appVersion,cid:O.clientID,sid:O.sessionID,sqs:O.sessionQS,tzo:O.timezoneOffset,referrer:O.referrer,events:[]},t=0;t<O.queue.length;t++){var n=O.queue[t];e.events.push(n.json())}O.queue=[],o.log("post to server:",e);var r=new Headers({Accept:"application/json","Content-Type":"application/json"});null!=O.authToken&&""!=O.authToken&&r.append("Authorization","BEARER "+O.authToken),fetch(O.metrixURL,{method:"POST",mode:"cors",credentials:"include",headers:r,body:JSON.stringify(e)}).then(function(e){if(204!==e.status)return e.json()}).then(function(e){o.log("metrix dispatch response:",e)}).catch(function(e){console.error("metrix:",e)})}},"undefined"!=typeof window&&void 0===window.fetch)throw"metrix.js requires fetch(), check your runtime and try again.";a||(a=new u.default),this.storage=a,this.serverHost=t.replace(/\/$/,""),this.metrixURL=""+this.serverHost+_,this.appVersion=n,n||console.error("metrix: appVersion is required."),this.authToken=r,this.identify(),this.intervalHandler=setInterval(this.identify,v),this.timezoneOffset=(new Date).getTimezoneOffset(),this.track=(0,i.default)(this.enqueue),this.sync=o.debounce(this.dispatch,S),this.queue=[]}return r(e,[{key:"clearIdentity",value:function(){var e=s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.storage.setCookie(f,"",0);case 3:return e.next=5,this.storage.setCookie(d,"",0);case 5:return e.next=7,this.storage.setCookie(I,"",0);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),N=t.MetrixNoop=function e(){E(this,e),this.track={event:function(){}}},A=c?O:N;t.default=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=arguments;t.log=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log.apply(null,t)},t.generateUID=function(){var e=Math.floor((new Date).getTime()/1e3);return Math.floor(1e9*Math.random())+"."+e},t.debounce=function(e,t,n){var o=void 0;return function(){var i=r,u=n&&!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(void 0,i)},t),u&&e.apply(void 0,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=n(3);t.default=function(e){return{event:function(t,n,r,o,u){var a=new i(t,n,r,o,u);e(a,null)},options:o.events}};var i=t.Event=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getCurrentURL=function(){if("undefined"!=typeof window&&window.location&&window.location.href)return window.location.href},this.module=t,this.section=n,this.element=r,this.eventType=o,this.ts=new Date,this.url=this.getCurrentURL(),this.data=i,this.verifyKeys()}return r(e,[{key:"verifyKeys",value:function(){var e=o.events.Module[this.module];null==e&&console.error("metrix: "+this.module+" is an unsupported module."),null==(e=o.events.Event[this.eventType])&&console.error("metrix: "+this.eventType+" is an unsupported event.")}},{key:"json",value:function(){var e={ts:this.ts,module:this.module,event_type:this.eventType,url:this.url};return this.section&&(e.section=this.section),this.element&&(e.element=this.element),this.data&&(this.data.hub_id&&(e.hub_id=this.data.hub_id,delete this.data.hub_id),this.data.post_id&&(e.post_id=this.data.post_id,delete this.data.post_id),this.data.account_id&&(e.account_id=this.data.account_id,delete this.data.account_id),this.data.org_id&&(e.account_id=this.data.org_id,delete this.data.org_id),this.data.object_id&&(e.object_id=this.data.object_id,delete this.data.object_id),e.data=this.data),e}}]),e}()},function(e,t){var n=function(){},r={events:{}};n("proto.events.Event"),n("proto.events.Module"),r.events.Module={INVALID_MODULE:0,LOGIN:100,SIGNUP:101,FEED:200,USER:300,ORG:301,USER_SETTINGS:400,ORG_SETTINGS:401,HUB:500,HUB_TEAM:501,HUB_SETTINGS:600,HUB_SETTINGS_DESIGN:601,HUB_SETTINGS_ADDONS:602,HUB_SETTINGS_COLLECTIONS:603,HUB_SETTINGS_EMBEDS:604,HUB_SETTINGS_INTEGRATIONS:605,HUB_SETTINGS_CTAS:606,HUB_MANAGE_CONTENT:700,HUB_NEWSLETTERS:701,HUB_NEWSLETTERS_TEMPLATES:702,HUB_NEWSLETTERS_MAILING_LISTS:703,HUB_ANALYTICS:704,HUB_COMPOSE:705,EMAIL:800,EMBED:900,BOOKMARKLET:901},r.events.Event={INVALID_EVENT:0,CREATE:1,VIEW:2,UPDATE:3,DELETE:4,OPEN:5,PUBLISH:15,UNPUBLISH:16,SCHEDULE:17,DRAFT:18,JOIN:6,LEAVE:7,INVITE:8,ACCEPT:9,REJECT:10,REQUEST_ACCESS:11,GRANT_ACCESS:12,DENY_ACCESS:13,REVOKE_ACCESS:14,FOLLOW:19,UNFOLLOW:20,LOGIN_FAIL:101,LOGIN_OK:102,ACCEPT_COOKIE:103,DISMISS_COOKIE:104,POST_LIKE:200,POST_UNLIKE:201,POST_SHARE:202,POST_AMPLIFY:203,POST_COMMENT:204,POST_COMMENT_DELETE:205,POST_SHARE_SCHEDULE:206,POST_FEATURE:207,POST_UNFEATURE:208,POST_PIN:209,POST_UNPIN:210,POST_HIDE:211,POST_UNHIDE:212,POST_REORDER:213,POST_COMMENT_UPDATE:214,POST_SHARE_INTENT:215,POST_SUBMITTED:216,POST_SUBMISSION_APPROVED:217,POST_SUBMISSION_REJECTED:218,EMAIL_PENDING_ACCEPTED:300,EMAIL_PENDING_DELAYED_UNKNOWN:301,EMAIL_PENDING_DELAYED_GRAYLIST:302,EMAIL_PENDING_DELAYED_RATE_LIMIT:303,EMAIL_PENDING_MAILBOX_FULL:304,EMAIL_PENDING_SERVER_ERROR:305,EMAIL_REJECTED_UNSUBSCRIBED:310,EMAIL_REJECTED_SPAM_COMPLAINT:311,EMAIL_REJECTED_INVALID_RECIPIENT:312,EMAIL_REJECTED_HARD_BOUNCED:313,EMAIL_REJECTED_UNKNOWN:314,EMAIL_BOUNCED_UNKNOWN:320,EMAIL_BOUNCED_DROPPED:321,EMAIL_BOUNCED_INVALID_RECIPIENT:322,EMAIL_BOUNCED_SPAM_SENDER:323,EMAIL_BOUNCED_SPAM_CONTENT:324,EMAIL_BOUNCED_TOO_LARGE:325,EMAIL_BOUNCED_BLOCKED:326,EMAIL_BOUNCED_MAILBOX_FULL:327,EMAIL_DELIVERED:330,EMAIL_DELIVERED_OPENED:331,EMAIL_DELIVERED_CLICKED:332,EMAIL_DELIVERED_SHARED:333,EMAIL_DELIVERED_UNSUBSCRIBED:334,EMAIL_DELIVERED_SPAM_COMPLAINT:335,VIEWER_LOAD:400,VIEWER_NAVIGATE:401,VIEWER_PRINT:402,VIEWER_PAGE_RENDERED:403,VIEWER_PAGE_FOCUS:404,VIEWER_SCROLL_START:405,VIEWER_SCROLL_END:406,VIEWER_ANNOTATION_CREATED:407,VIEWER_ANNOTATION_DELETED:408,VIEWER_PLAY:409,VIEWER_PAUSE:410,VIEWER_SEEK:411,VIEWER_SPEED_CHANGE:412,VIEWER_BANDWIDTH_ADAPT:413,GET_FOCUS:500,LOSE_FOCUS:501},e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var u=t[o](i),a=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getCookies",value:function(){var e=o(regeneratorRuntime.mark(function e(t){var n,r,o,i,u,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},r=document.cookie.split(";"),o=0;case 3:if(!(o<t.length)){e.next=20;break}i=t[o],u=i+"=",n[i]="",a=0;case 8:if(!(a<r.length)){e.next=17;break}for(s=r[a];" "==s.charAt(0);)s=s.substring(1);if(0!=s.indexOf(u)){e.next=14;break}return n[i]=s.substring(u.length,s.length),e.abrupt("break",17);case 14:a++,e.next=8;break;case 17:o++,e.next=3;break;case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCookie",value:function(){var e=o(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCookies([t]);case 2:return n=e.sent,e.abrupt("return",n[t]);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setCookie",value:function(){var e=o(regeneratorRuntime.mark(function e(t,n,r){var o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(o=new Date).setTime(o.getTime()+60*r*1e3),i="expires="+o.toUTCString(),document.cookie=t+"="+n+";"+i+";path=/";case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}();t.default=i}])});